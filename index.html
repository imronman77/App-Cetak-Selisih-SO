<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SO Report Generator</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1a73e8" />

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    .container {
      max-width: 480px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    input, button {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }
    button {
      background: #1a73e8;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background: #155fc0;
    }
    iframe {
      width: 100%;
      height: 500px;
      border: 1px solid #ccc;
      border-radius: 8px;
      margin-top: 15px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h2>SO Report Generator</h2>

    <label>Tanggal Periode (DD-MM-YYYY)</label>
    <input type="text" id="dateSo" placeholder="27-11-2025" />

    <label>Kode Toko</label>
    <input type="text" id="storeId" placeholder="L257" />

    <button onclick="generateLink()">Cek Selisih</button>

    <button id="refreshBtn" style="display:none; background:#28a745;" onclick="refreshIframe()">Refresh Tampilan</button>

    <iframe id="resultFrame" src="" style="display:none;"></iframe>
  </div>


  <script>
    function generateLink() {
      const storeId = document.getElementById("storeId").value;
      const dateSo = document.getElementById("dateSo").value;

      if (!storeId || !dateSo) {
        alert("Store ID dan Tanggal harus diisi!");
        return;
      }

      const url = `https://app.alfastore.co.id/prd/api/rpt/laporan_so/csel_last_so_absolute_desc?storeId=${storeId}&dateSo=${dateSo}`;

      const iframe = document.getElementById("resultFrame");
      iframe.src = url;
      iframe.style.display = "block";

      document.getElementById("refreshBtn").style.display = "block";
    }

    function refreshIframe() {
      const iframe = document.getElementById("resultFrame");
      iframe.src = iframe.src;
    }

    // Register Service Worker
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", function () {
        navigator.serviceWorker.register("service-worker.js")
          .then(() => console.log("SW Registered"))
          .catch(err => console.log("SW Error", err));
      });
    }
  </script>
</body>
</html>
